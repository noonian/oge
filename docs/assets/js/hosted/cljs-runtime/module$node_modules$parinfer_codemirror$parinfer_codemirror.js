shadow$provide.module$node_modules$parinfer_codemirror$parinfer_codemirror=function(P,U,y,L,F){(function(a,m){"function"===typeof define&&define.amd?define(["parinfer"],m):"object"===typeof L&&L.exports?L.exports=m(y("module$node_modules$parinfer$parinfer")):a.parinferCodeMirror=m(a.parinfer)})(this,function(a){function m(a){return"parinferCodeMirror: "+a}function G(a){if(-1===M.indexOf(a))throw m('Mode "'+a+'" is invalid. Must be one of: '+M.join(","));}function C(a){a=a.__parinfer__;if(!a)throw m("You must call parinferCodeMirror.init(cm) on a CodeMirror instance before you can use the rest of the API.");
return a}function x(a){return a.map(function(a){return{x:a.from.ch,lineNo:a.from.line,oldText:a.removed.join("\n"),newText:a.text.join("\n")}})}function r(a,b){var f=a.getAllMarks();for(a=0;a<f.length;a++)f[a].className===b&&f[a].clear()}function z(a,b,d,g,h){a.markText({line:b,ch:d},{line:b,ch:g},{className:h})}function B(a,b){r(a,"parinfer-error");b&&(z(a,b.lineNo,b.x,b.x+1,"parinfer-error"),b.extra&&z(a,b.extra.lineNo,b.extra.x,b.extra.x+1,"parinfer-error"))}function T(a,b){r(a,"parinfer-paren-trail");
if(b){var f;for(f=0;f<b.length;f++){var d=b[f];z(a,d.lineNo,d.startX,d.endX,"parinfer-paren-trail")}}}function q(a){a=a.listSelections()[0];return Math.min(a.head.line,a.anchor.line)}function d(a,b,d){if(!a)return null;var f,g;for(f=0;f<a.length;f++){var h=a[f];if(b<h){var k=h;break}b>h&&(g=h)}if(-1===d)return g;if(1===d)return k}function b(a,b){a=a.getLine(b);for(b=0;b<a.length;b++)if(" "!==a[b])return b;return null}function n(a,f){var g=a.somethingSelected(),h;if(h=C(a).tabStops){var k=[],n;for(n=
0;n<h.length;n++){var m=h[n];-1>=m.x&&k.pop();k.push(m.x);k.push(m.x+("("===m.ch?2:1));null!=m.argX&&k.push(m.argX)}h=k}else h=null;g?(g=h,h=q(a),h=b(a,h),g=d(g,h,f),null==g&&(g=Math.max(0,h+2*f)),a.indentSelection(g-h)):(n=h,k=a.getCursor(),g=k.line,h=k.ch,k=b(a,k.line),n=d(n,h,f),f=null==n||null!=k&&h!==k?Math.max(0,h+2*f):n,null!=k&&k<h&&h<f?(f=Array(f-h+1).join(" "),a.replaceSelection(f)):(f-=h,""!==a.getDoc().getLine(g).trim()?a.indentLine(g,f):0<f?(f=Array(f+1).join(" "),a.replaceSelection(f)):
(h=a.getCursor().ch,a.replaceRange("",{line:g,ch:h+f},{line:g,ch:h},"+indent"))))}function I(a,b){return b.line===a.lineNo&&a.startX<=b.ch}function g(a,b){var f;for(f=0;f<b.length;f++){var d=a,h=b[f],k=d.getDoc().sel,n=k.ranges[0];(n=h.lineNo===h.closer.lineNo||!h.closer.trail||I(h.closer.trail,n.anchor)||I(h.closer.trail,n.head))||(n=h.closer,n=-1!==k.contains({line:n.lineNo,ch:n.x}));n||z(d,h.closer.lineNo,h.closer.x,h.closer.x+1,"parinfer-locus-paren");g(d,h.children)}}function h(a,b){a=a.charCoords({line:b.lineNo,
ch:b.x},"local");return{midx:a.left+(a.right-a.left)/2,right:a.right,left:a.left,top:a.top,bottom:a.bottom}}function E(a,b){var f;for(f=0;f<b.length;f++){var d=a,g=b[f],k=d.__parinfer__.layer,n=k.paper,q=h(d,g),m=h(d,g.closer);if(g.closer.trail&&g.lineNo!==g.closer.lineNo)switch(k.type){case "guides":n.path(["M",q.midx,q.bottom,"V",m.bottom].join(" "));break;case "locus":k=d;var D=g.lineNo;for(var w=g.closer.lineNo,r=k.getDoc(),I=0,z=0;D<=w;D++){var B=r.getLine(D);B.length>I&&(I=B.length,z=D)}k=h(k,
{lineNo:z,x:I}).right;n.path(["M",q.midx,q.top+4,"A",4,4,0,0,1,q.midx+4,q.top,"H",k-4,"A",4,4,0,0,1,k,q.top+4,"V",m.bottom,"H",q.midx,"V",q.bottom].join(" "))}E(d,g.children)}}function w(a,b){a=a.__parinfer__.layer;a.type=b;b=document.createElement("div");b.style.position="absolute";b.style.left="0";b.style.top="0";b.style["z-index"]=100;b.className="parinfer-locus";a.el=b;a.container.appendChild(b);a.paper=Raphael(b,a.container.clientWidth,a.container.clientHeight)}function k(a){(a=a.__parinfer__.layer)&&
a.el&&a.container.removeChild(a.el)}function ea(a,b){r(a,"parinfer-locus-paren");b&&(g(a,b),k(a),w(a,"guides"),E(a,b))}function y(a,b){b&&(k(a),w(a,"guides"),E(a,b))}function R(b,f){var d=b.cm,g=d.getValue(),h=d.somethingSelected(),k=d.listSelections(),n=d.getCursor(),m=d.getScrollerElement();n={cursorLine:n.line,cursorX:n.ch,prevCursorLine:b.prevCursorLine,prevCursorX:b.prevCursorX};h&&(n.selectionStartLine=q(d));if(b.options)for(var w in b.options)b.options.hasOwnProperty(w)&&(n[w]=b.options[w]);
f&&(n.changes=x(f));w=b.options&&b.options.locus;var D=b.options&&b.options.guides;if(w||D)delete n.locus,delete n.guides,n.returnParens=!0;var r=b.fixMode?"paren":b.mode;switch(r){case "indent":var E=a.indentMode(g,n);break;case "paren":E=a.parenMode(g,n);break;case "smart":E=a.smartMode(g,n);break;default:G(r)}b.parens=E.parens;b.tabStops=E.tabStops;g!==E.text&&(g=d.getHistory(),d.setValue(E.text),b.monitorCursor=!1,h?d.setSelections(k):d.setCursor(E.cursorLine,E.cursorX),d.setHistory(g),setTimeout(function(){b.monitorCursor=
!0},0),d.scrollTo(m.scrollLeft,m.scrollTop));B(d,E.error);T(d,E.parenTrails);b.prevCursorLine=E.cursorLine;b.prevCursorX=E.cursorX;w?ea(d,E.parens):D&&y(d,E.parens);return b.fixMode&&E.success?(b.fixMode=!1,R(b,f)):E.success}function ha(a){clearTimeout(a.cursorTimeout);a.monitorCursor&&(a.cursorTimeout=setTimeout(function(){R(a)},0))}function X(a){if(!a.enabled){a.callbackCursor=function(b){ha(a)};a.callbackChanges=function(b,d){clearTimeout(a.cursorTimeout);"setValue"!==d[0].origin&&R(a,d)};var b=
a.cm;b.on("cursorActivity",a.callbackCursor);b.on("changes",a.callbackChanges);a.parinferKeys={Tab:function(a){n(a,1)},"Shift-Tab":function(a){n(a,-1)}};b.addKeyMap(a.parinferKeys);a.enabled=!0}}function da(a){a=C(a);"paren"!==a.mode&&(a.fixMode=!0);X(a);return R(a)}var M=["paren","indent","smart"];return{version:"1.4.2",init:function(a,b,d){var f=a.__parinfer__;if(f)throw m("init has already been called on this CodeMirror instance");b=b||"smart";G(b);f={cm:a,mode:b,options:d,enabled:!1,cursorTimeout:null,
monitorCursor:!0,prevCursorX:null,prevCursorLine:null,callbackCursor:null,callbackChanges:null};b=a.__parinfer__=f;d=a.getWrapperElement().querySelector(".CodeMirror-lines").parentNode;b.layer={container:d};return da(a)},enable:da,disable:function(a){a=C(a);if(a.enabled){var b=a.cm;r(b,"parinfer-error");r(b,"parinfer-paren-trail");b.off("cursorActivity",a.callbackCursor);b.off("changes",a.callbackChanges);b.removeKeyMap(a.parinferKeys);a.enabled=!1}},setMode:function(a,b){a=C(a);G(b);a.mode=b;return R(a)},
setOptions:function(a,b){a=C(a);a.options=b;return R(a)}}})}
//# sourceMappingURL=module$node_modules$parinfer_codemirror$parinfer_codemirror.js.map
