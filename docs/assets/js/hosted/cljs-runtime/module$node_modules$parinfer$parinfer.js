shadow$provide.module$node_modules$parinfer$parinfer=function(P,U,y,L,F){(function(a,m){"function"===typeof define&&define.amd?define([],m):"object"===typeof L&&L.exports?L.exports=m():a.parinfer=m()})(this,function(){function a(a){return"number"===typeof a&&isFinite(a)&&Math.floor(a)===a}function m(a){a=a||{};return{cursorX:a.cursorX,cursorLine:a.cursorLine,prevCursorX:a.prevCursorX,prevCursorLine:a.prevCursorLine,selectionStartLine:a.selectionStartLine,changes:a.changes,partialResult:a.partialResult,
forceBalance:a.forceBalance,returnParens:a.returnParens}}function G(){return{lineNo:-999,startX:-999,endX:-999,openers:[],clamped:{startX:-999,endX:-999,openers:[]}}}function C(a,b){var f={lineNo:a.lineNo,x:a.x,inputLineNo:a.inputLineNo,inputX:a.inputX};return a.errorPosCache[b]=f}function x(a,b){var f=a.errorPosCache[b],d=a.partialResult?"lineNo":"inputLineNo",g=a.partialResult?"x":"inputX",h={parinferError:!0,name:b,message:da[b],lineNo:f?f[d]:a[d],x:f?f[g]:a[g]},k=B(a.parenStack,0);if("unmatched-close-paren"===
b){if((f=a.errorPosCache["unmatched-open-paren"])||k)h.extra={name:"unmatched-open-paren",lineNo:f?f[d]:k[d],x:f?f[g]:k[g]}}else"unclosed-paren"===b&&(h.lineNo=k[d],h.x=k[g]);return h}function r(a,b,f,d,g){var h=a.lines[b];h=h.substring(0,f)+g+h.substring(d);a.lines[b]=h;g=g.length-(d-f);0!==g&&a.cursorLine===b&&-999!==a.cursorX&&(a.cursorX===f&&a.cursorX===d?0===a.cursorX:a.cursorX>=d)&&(a.cursorX+=g)}function z(a){a.x=0;a.lineNo++;a.indentX=-999;a.commentX=-999;a.indentDelta=0;delete a.errorPosCache["unmatched-close-paren"];
delete a.errorPosCache["unmatched-open-paren"];delete a.errorPosCache["leading-close-paren"];a.trackingArgTabStop=null;a.trackingIndent=!a.isInStr}function B(a,b){var f=a.length-1;return b>f?null:a[f-b]}function T(a){return"}"===a||")"===a||"]"===a}function q(a,b){return 0===a.length?!1:B(a,0).ch===X[b]}function d(a){var b=a.ch;return!a.isEscaped&&(" "===b||"  "===b)}function b(a,b,f,d){return b===d&&-999!==f&&-999!==a&&a>f}function n(a,b,f){a.parenTrail.lineNo=b;a.parenTrail.startX=f;a.parenTrail.endX=
f;a.parenTrail.openers=[];a.parenTrail.clamped.startX=-999;a.parenTrail.clamped.endX=-999;a.parenTrail.clamped.openers=[]}function I(a,b){var f;for(f=0;f<a.parenStack.length;f++){var d=B(a.parenStack,f),g=d.x<b,h=d.x-d.indentDelta<b-a.indentDelta,k=!1;h&&g?k=!0:h||g?h&&!g?k=0===a.indentDelta?!0:!1:!h&&g&&((g=B(a.parenStack,f+1))&&g.indentDelta<=d.indentDelta?k=b+g.indentDelta>d.x?!0:!1:g&&g.indentDelta>d.indentDelta?k=!0:a.indentDelta>d.indentDelta&&(k=!0),k&&(d.indentDelta=0)):k=!1;if(k)break}return f}
function g(a,b){if(b){var f=B(a.parenStack,0);f?f.maxChildIndent=b.x:a.maxIndent=b.x}}function h(a){var b=a.parenTrail,f=b.clamped.openers.concat(b.openers);if(0<f.length&&(b={lineNo:b.lineNo,startX:-999!==b.clamped.startX?b.clamped.startX:b.startX,endX:0===b.openers.length?b.clamped.endX:b.endX},a.parenTrails.push(b),a.returnParens))for(a=0;a<f.length;a++)f[a].closer.trail=b}function E(a,b){var f=a.x,d=f+b,g,h="";for(g=0;g<d;g++)h+=" ";r(a,a.lineNo,0,f,h);a.x=d;a.indentX=d;a.indentDelta+=b}function w(a){a.indentX=
a.x;a.trackingIndent=!1;if(a.quoteDanger)throw x(a,"quote-danger");if("INDENT_MODE"===a.mode){var b="",f=I(a,a.x),d;for(d=0;d<f;d++){var g=a.parenStack.pop();a.parenTrail.openers.push(g);var k=X[g.ch];b+=k;if(a.returnParens){var n=a.parenTrail.startX+d;g.closer.lineNo=a.parenTrail.lineNo;g.closer.x=n;g.closer.ch=k}}-999!==a.parenTrail.lineNo&&(r(a,a.parenTrail.lineNo,a.parenTrail.startX,a.parenTrail.endX,b),a.parenTrail.endX=a.parenTrail.startX+b.length,h(a));(b=B(a.parenStack,0))&&b.indentDelta!==
a.indentDelta&&E(a,b.indentDelta)}else if("PAREN_MODE"===a.mode){k=b=a.x;f=0;d=a.maxIndent;if(g=B(a.parenStack,0))f=g.x+1,d=g.maxChildIndent,g.indentDelta!==a.indentDelta&&(k+=g.indentDelta);-999!==f&&(k=Math.max(f,k));-999!==d&&(k=Math.min(d,k));k!==b&&E(a,k-b)}}function k(a,b){a={ch:b.ch,x:b.x,lineNo:b.lineNo};null!=b.argX&&(a.argX=b.argX);return a}function ea(a,b){a.ch=b;a.skipChar=!1;if(a.changes&&(a.smart||"PAREN_MODE"===a.mode)){var f=a.changes[a.inputLineNo];f&&(f=f[a.inputX])&&(a.indentDelta+=
f.newEndX-f.oldEndX)}if(a.trackingIndent)if(T(a.ch)){if("INDENT_MODE"===a.mode){if(!a.forceBalance){if(a.smart)throw{leadingCloseParen:!0};a.errorPosCache["leading-close-paren"]||C(a,"leading-close-paren")}a.skipChar=!0}if("PAREN_MODE"===a.mode)if(q(a.parenStack,a.ch)){f=a.cursorX;var k=a.x;if(a.cursorLine===a.lineNo&&-999!==k&&-999!==f&&f<=k)n(a,a.lineNo,a.x),w(a);else{f=a.parenStack.pop();k=X[f.ch];if(a.returnParens){var m=a.parenTrail.endX;f.closer.lineNo=a.parenTrail.lineNo;f.closer.x=m;f.closer.ch=
k}g(a,f);m=a.parenTrail.endX;r(a,a.parenTrail.lineNo,m,m,k);a.parenTrail.endX++;a.parenTrail.openers.push(f);(f=a.parenTrails[a.parenTrails.length-1])&&f.lineNo===a.parenTrail.lineNo?(f.endX=a.parenTrail.endX,a.returnParens&&(a.parenTrail.openers[a.parenTrail.openers.length-1].closer.trail=f)):h(a);a.skipChar=!0}}else if(a.smart)a.skipChar=!0;else throw x(a,"unmatched-close-paren");}else if(";"===a.ch){f=a.parenTrail.openers.length;if("PAREN_MODE"===a.mode)for(k=0;k<f;k++)a.parenStack.push(B(a.parenTrail.openers,
k));k=I(a,a.x);(k=B(a.parenStack,k))&&k.indentDelta!==a.indentDelta&&E(a,k.indentDelta);if("PAREN_MODE"===a.mode)for(k=0;k<f;k++)a.parenStack.pop();a.trackingIndent=!1}else"\n"!==a.ch&&" "!==a.ch&&"\t"!==a.ch&&w(a);if(a.skipChar)a.ch="";else{f=a.ch;a.isEscaped=!1;if(a.isEscaping){if(a.isEscaping=!1,a.isEscaped=!0,"\n"===a.ch){if(a.isInCode)throw x(a,"eol-backslash");a.isInComment=!1;a.ch=""}}else if("{"===f||"("===f||"["===f)a.isInCode&&(f={inputLineNo:a.inputLineNo,inputX:a.inputX,lineNo:a.lineNo,
x:a.x,ch:a.ch,indentDelta:a.indentDelta,maxChildIndent:-999},a.returnParens&&(f.children=[],f.closer={lineNo:-999,x:-999,ch:""},k=(k=B(a.parenStack,0))?k.children:a.parens,k.push(f)),a.parenStack.push(f),a.trackingArgTabStop="space");else if(T(f)){if(a.isInCode)if(q(a.parenStack,a.ch)){f=B(a.parenStack,0);a.returnParens&&(k=a.x,m=a.ch,f.closer.lineNo=a.lineNo,f.closer.x=k,f.closer.ch=m);a.parenTrail.endX=a.x+1;a.parenTrail.openers.push(f);if(f="INDENT_MODE"===a.mode&&a.smart){f=B(a.parenStack,0);
k=(k=B(a.parenStack,1))?k.x+1:0;m=f.x;var D=a.cursorLine===f.lineNo&&k<=a.cursorX&&a.cursorX<=m;if(!a.changes&&-999!==a.prevCursorLine&&a.prevCursorLine===f.lineNo&&k<=a.prevCursorX&&a.prevCursorX<=m&&!D)throw{releaseCursorHold:!0};f=D}f&&(f=a.parenTrail.startX,k=a.parenTrail.endX,m=a.parenTrail.openers,n(a,a.lineNo,a.x+1),a.parenTrail.clamped.startX=f,a.parenTrail.clamped.endX=k,a.parenTrail.clamped.openers=m);a.parenStack.pop();a.trackingArgTabStop=null}else{if("PAREN_MODE"===a.mode){if(f=a.parenTrail,
f=f.lineNo===a.lineNo&&f.startX===a.indentX,!a.smart||!f)throw x(a,"unmatched-close-paren");}else"INDENT_MODE"===a.mode&&!a.errorPosCache["unmatched-close-paren"]&&(C(a,"unmatched-close-paren"),f=B(a.parenStack,0))&&(k=C(a,"unmatched-open-paren"),k.inputLineNo=f.inputLineNo,k.inputX=f.inputX);a.ch=""}}else'"'===f?a.isInStr?a.isInStr=!1:a.isInComment?(a.quoteDanger=!a.quoteDanger,a.quoteDanger&&C(a,"quote-danger")):(a.isInStr=!0,C(a,"unclosed-quote")):";"===f?a.isInCode&&(a.isInComment=!0,a.commentX=
a.x,a.trackingArgTabStop=null):"\\"===f?a.isEscaping=!0:"\t"===f?a.isInCode&&(a.ch="  "):"\n"===f&&(a.isInComment=!1,a.ch="");f=a.ch;a.isInCode=!a.isInComment&&!a.isInStr;k=a.ch;m=T(k)&&!a.isEscaped;a.isInCode&&!d(a)&&""!==k&&!m&&n(a,a.lineNo,a.x+f.length);if(f=a.trackingArgTabStop)"space"===f?a.isInCode&&d(a)&&(a.trackingArgTabStop="arg"):"arg"!==f||d(a)||(B(a.parenStack,0).argX=a.x,a.trackingArgTabStop=null)}f=a.ch;b!==f&&(r(a,a.lineNo,a.x,a.x+b.length,f),a.indentDelta-=b.length-f.length);a.x+=
f.length}function y(d,n,f,q){f={mode:f,smart:q,origText:d,origCursorX:-999,origCursorLine:-999,inputLines:d.split(ha),inputLineNo:-1,inputX:-1,lines:[],lineNo:-1,ch:"",x:0,indentX:-999,parenStack:[],tabStops:[],parenTrail:G(),parenTrails:[],returnParens:!1,parens:[],cursorX:-999,cursorLine:-999,prevCursorX:-999,prevCursorLine:-999,selectionStartLine:-999,changes:null,isInCode:!0,isEscaping:!1,isEscaped:!1,isInStr:!1,isInComment:!1,commentX:-999,quoteDanger:!1,trackingIndent:!1,skipChar:!1,success:!1,
partialResult:!1,forceBalance:!1,maxIndent:-999,indentDelta:0,trackingArgTabStop:null,error:{name:null,message:null,lineNo:null,x:null,extra:{name:null,lineNo:null,x:null}},errorPosCache:{}};if(n){a(n.cursorX)&&(f.cursorX=n.cursorX,f.origCursorX=n.cursorX);a(n.cursorLine)&&(f.cursorLine=n.cursorLine,f.origCursorLine=n.cursorLine);a(n.prevCursorX)&&(f.prevCursorX=n.prevCursorX);a(n.prevCursorLine)&&(f.prevCursorLine=n.prevCursorLine);a(n.selectionStartLine)&&(f.selectionStartLine=n.selectionStartLine);
if(Array.isArray(n.changes)){var m=n.changes;if(0===m.length)m=null;else{var D={},O,E;for(E=0;E<m.length;E++){if(O=m[E]){var I=O.newText.split(ha);var R=O.oldText.split(ha);var H=(1===I.length?O.x:0)+I[I.length-1].length;I=O.lineNo+(I.length-1);R={x:O.x,lineNo:O.lineNo,oldText:O.oldText,newText:O.newText,oldEndX:(1===R.length?O.x:0)+R[R.length-1].length,newEndX:H,newEndLineNo:I,lookupLineNo:I,lookupX:H}}else R=void 0;(O=D[R.lookupLineNo])||(O=D[R.lookupLineNo]={});O[R.lookupX]=R}m=D}f.changes=m}"boolean"===
typeof n.partialResult&&(f.partialResult=n.partialResult);"boolean"===typeof n.forceBalance&&(f.forceBalance=n.forceBalance);"boolean"===typeof n.returnParens&&(f.returnParens=n.returnParens)}try{var S;for(S=0;S<f.inputLines.length;S++){f.inputLineNo=S;m=void 0;D=f;E=S;z(D);D.lines.push(D.inputLines[E]);O=void 0;R=D;if((-999!==R.selectionStartLine?R.selectionStartLine:R.cursorLine)===R.lineNo){for(O=0;O<R.parenStack.length;O++)R.tabStops.push(k(R,R.parenStack[O]));if("PAREN_MODE"===R.mode)for(O=R.parenTrail.openers.length-
1;0<=O;O--)R.tabStops.push(k(R,R.parenTrail.openers[O]));for(O=1;O<R.tabStops.length;O++){var M=R.tabStops[O].x,C=R.tabStops[O-1].argX;null!=C&&C>=M&&delete R.tabStops[O-1].argX}}for(m=0;m<D.inputLines[E].length;m++)D.inputX=m,ea(D,D.inputLines[E][m]);ea(D,"\n");if(!D.forceBalance){var X=D.errorPosCache["unmatched-close-paren"];if(X&&X.x<D.parenTrail.startX)throw x(D,"unmatched-close-paren");if(D.errorPosCache["leading-close-paren"]&&D.parenTrail.lineNo===D.lineNo)throw x(D,"leading-close-paren");
}if(D.lineNo===D.parenTrail.lineNo)if(m=D,m.isInStr)m.parenTrail=G();else if("INDENT_MODE"===m.mode){D=void 0;E=m;var Ea=E.parenTrail.startX,aa=E.parenTrail.endX;O=E;var da=E.cursorX,qa=E.cursorLine;if(b(da,qa,O.parenTrail.startX,O.lineNo)&&!b(da,qa,O.commentX,O.lineNo)){var ya=Math.max(Ea,E.cursorX),la=Math.max(aa,E.cursorX),t=E.lines[E.lineNo];O=0;for(D=Ea;D<ya;D++)T(t[D])&&O++;var J=E.parenTrail.openers;E.parenTrail.openers=J.slice(O);E.parenTrail.startX=ya;E.parenTrail.endX=la;E.parenTrail.clamped.openers=
J.slice(0,O);E.parenTrail.clamped.startX=Ea;E.parenTrail.clamped.endX=aa}if(m.parenTrail.startX!==m.parenTrail.endX)for(var c=m.parenTrail.openers;0!==c.length;)m.parenStack.push(c.pop())}else if("PAREN_MODE"===m.mode){g(m,B(m.parenTrail.openers,0));if(m.lineNo!==m.cursorLine){D=void 0;E=m;var N=E.parenTrail.startX,oa=E.parenTrail.endX;if(N!==oa&&E.lineNo===E.parenTrail.lineNo){var Va=E.lines[E.lineNo];O="";R=0;for(D=N;D<oa;D++)T(Va[D])?O+=Va[D]:R++;0<R&&(r(E,E.lineNo,N,oa,O),E.parenTrail.endX-=R)}}h(m)}}if(f.quoteDanger)throw x(f,
"quote-danger");if(f.isInStr)throw x(f,"unclosed-quote");if(0!==f.parenStack.length&&"PAREN_MODE"===f.mode)throw x(f,"unclosed-paren");"INDENT_MODE"===f.mode&&(z(f),w(f));f.success=!0}catch(ra){if(ra.leadingCloseParen||ra.releaseCursorHold)return y(d,n,"PAREN_MODE",q);d=ra;f.success=!1;if(d.parinferError)delete d.parinferError,f.error=d;else throw f.error.name="unhandled",f.error.message=d.stack,d;}return f}function R(a){var b=-1!==a.origText.search("\r")?"\r\n":"\n";a.success?(b={text:a.lines.join(b),
cursorX:a.cursorX,cursorLine:a.cursorLine,success:!0,tabStops:a.tabStops,parenTrails:a.parenTrails},a.returnParens&&(b.parens=a.parens)):(b={text:a.partialResult?a.lines.join(b):a.origText,cursorX:a.partialResult?a.cursorX:a.origCursorX,cursorLine:a.partialResult?a.cursorLine:a.origCursorLine,parenTrails:a.partialResult?a.parenTrails:null,success:!1,error:a.error},a.partialResult&&a.returnParens&&(b.parens=a.parens));-999===b.cursorX&&delete b.cursorX;-999===b.cursorLine&&delete b.cursorLine;b.tabStops&&
0===b.tabStops.length&&delete b.tabStops;return b}var ha=/\r?\n/,X={"{":"}","}":"{","[":"]","]":"[","(":")",")":"("},da={"quote-danger":"Quotes must balanced inside comment blocks.","eol-backslash":"Line cannot end in a hanging backslash.","unclosed-quote":"String is missing a closing quote.","unclosed-paren":"Unclosed open-paren.","unmatched-close-paren":"Unmatched close-paren.","unmatched-open-paren":"Unmatched open-paren.","leading-close-paren":"Line cannot lead with a close-paren.",unhandled:"Unhandled error."};
return{version:"3.12.0",indentMode:function(a,b){b=m(b);return R(y(a,b,"INDENT_MODE"))},parenMode:function(a,b){b=m(b);return R(y(a,b,"PAREN_MODE"))},smartMode:function(a,b){b=m(b);return R(y(a,b,"INDENT_MODE",null==b.selectionStartLine))}}})}
//# sourceMappingURL=module$node_modules$parinfer$parinfer.js.map
